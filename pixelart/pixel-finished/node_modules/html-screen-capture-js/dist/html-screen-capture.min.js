!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("htmlScreenCaptureJs",[],t):"object"==typeof exports?exports.htmlScreenCaptureJs=t():e.htmlScreenCaptureJs=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){a(this,e),this.OBJECT="object",this.STRING="string",this.URI="uri",this.BASE64="base64"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return(new l.default).capture(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.OutputType=void 0,t.capture=r;var s=n(0),o=a(s),i=n(2),l=a(i);t.OutputType=new o.default},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(3),i=a(o),l=n(4),u=a(l),c=n(0),d=a(c),h=function(){function e(){r(this,e),this._logger=new i.default,this._isHead=!0,this._classMap={},this._classCount=0,this._shouldHandleImgDataUrl=!0,this._canvas=null,this._ctx=null,this._doc=null,this._options={tagsOfIgnoredDocHeadElements:["script","link","style"],tagsOfIgnoredDocBodyElements:["script"],classesOfIgnoredDocBodyElements:[],attrKeyValuePairsOfIgnoredElements:{},tagsOfSkippedElementsForChildTreeCssHandling:["svg"],attrKeyForSavingElementOrigClass:"_class",attrKeyForSavingElementOrigStyle:"_style",prefixForNewGeneratedClasses:"c",imageFormatForDataUrl:"image/png",imageQualityForDataUrl:.92,rulesToAddToDocStyle:[]}}return s(e,[{key:"_overrideOptions",value:function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t])}},{key:"_getCanvasDataUrl",value:function(e){var t="";try{t=e.toDataURL(this._options.imageFormatForDataUrl,this._options.imageQualityForDataUrl)}catch(e){this._logger.warn("getCanvasDataUrl() - "+e.message)}return t}},{key:"_getImgDataUrl",value:function(e){var t="";try{this._canvas||(this._canvas=this._doc.createElement("canvas"),this._ctx=this._canvas.getContext("2d")),this._canvas.width=e.clientWidth,this._canvas.height=e.clientHeight,this._ctx.drawImage(e,0,0),t=this._getCanvasDataUrl(this._canvas)}catch(e){this._logger.warn("getImgDataUrl() - "+e.message),this._shouldHandleImgDataUrl=!1}return t}},{key:"_getClasses",value:function(e){var t=[],n=e.className instanceof SVGAnimatedString?e.className.baseVal:e.className;if(n){n.split(" ").forEach(function(e){e&&t.push(e)})}return t}},{key:"_handleElmCss",value:function(t,n){this._getClasses(n).length>0&&(this._options.attrKeyForSavingElementOrigClass&&n.setAttribute(this._options.attrKeyForSavingElementOrigClass,e._getClassName(n)),n.removeAttribute("class")),n.getAttribute("style")&&(this._options.attrKeyForSavingElementOrigStyle&&n.setAttribute(this._options.attrKeyForSavingElementOrigStyle,n.getAttribute("style")),n.removeAttribute("style"));for(var a=getComputedStyle(t),r="",s=0;s<a.length;s++){var o=a.item(s),i=a.getPropertyValue(o),l=o+":"+i,u=this._classMap[l];u||(this._classCount++,u=(this._options.prefixForNewGeneratedClasses?this._options.prefixForNewGeneratedClasses:"c")+this._classCount,this._classMap[l]=u),r+=u+" "}r&&n.setAttribute("class",r.trim())}},{key:"_appendNewStyle",value:function(e){var t=this._doc.createElement("style");t.type="text/css";var n=this._options.rulesToAddToDocStyle?this._options.rulesToAddToDocStyle.join(""):"";for(var a in this._classMap)this._classMap.hasOwnProperty(a)&&(n+="."+this._classMap[a]+"{"+a+"}");t.styleSheet?t.styleSheet.cssText=n:t.appendChild(this._doc.createTextNode(n)),e.children[0].appendChild(t)}},{key:"_shouldIgnoreElm",value:function(e){var t=this,n=!1;if((this._isHead&&this._options.tagsOfIgnoredDocHeadElements&&this._options.tagsOfIgnoredDocHeadElements.indexOf(e.tagName.toLowerCase())>-1||!this._isHead&&this._options.tagsOfIgnoredDocBodyElements&&this._options.tagsOfIgnoredDocBodyElements.indexOf(e.tagName.toLowerCase())>-1)&&(n=!0),!n&&this._options.attrKeyValuePairsOfIgnoredElements)for(var a in this._options.attrKeyValuePairsOfIgnoredElements)if(this._options.attrKeyValuePairsOfIgnoredElements.hasOwnProperty(a))for(var r=0;r<e.attributes.length;r++)e.attributes[r].specified&&e.attributes[r].value===this._options.attrKeyValuePairsOfIgnoredElements[a]&&(n=!0);if(!n&&!this._isHead&&this._options.classesOfIgnoredDocBodyElements){this._getClasses(e).forEach(function(e){!n&&t._options.classesOfIgnoredDocBodyElements.indexOf(e)>-1&&(n=!0)})}return n}},{key:"_recursiveWalk",value:function(t,n,a){if(this._shouldHandleImgDataUrl&&!this._isHead&&"img"===t.tagName.toLowerCase()){var r=this._getImgDataUrl(t);r&&n.setAttribute("src",r)}if(!this._isHead&&"canvas"===t.tagName.toLowerCase()){var s=this._getCanvasDataUrl(t);s&&n.setAttribute("src",s),n.outerHTML=n.outerHTML.replace(/<canvas/g,"<img")}if(t.value&&e._handleElmValue(t,n),a&&(this._handleElmCss(t,n),this._options.tagsOfSkippedElementsForChildTreeCssHandling&&this._options.tagsOfSkippedElementsForChildTreeCssHandling.indexOf(t.tagName.toLowerCase())>-1&&(a=!1)),t.children)for(var o=t.children.length-1;o>=0;o--)this._shouldIgnoreElm(t.children[o])?n.removeChild(n.children[o]):this._recursiveWalk(t.children[o],n.children[o],a)}},{key:"_createNewHtml",value:function(){var e=this._doc.documentElement.cloneNode(!1);return this._handleElmCss(this._doc.documentElement,e),e}},{key:"_appendNewHead",value:function(e){var t=this._doc.head.cloneNode(!0);this._isHead=!0,this._recursiveWalk(this._doc.head,t,!1),e.appendChild(t)}},{key:"_appendNewBody",value:function(e){var t=this._doc.body.cloneNode(!0);this._isHead=!1,this._recursiveWalk(this._doc.body,t,!0),e.appendChild(t)}},{key:"_getHtmlObject",value:function(){var e=this._createNewHtml();return this._appendNewHead(e),this._appendNewBody(e),this._appendNewStyle(e),e}},{key:"_prepareOutput",value:function(e,t){var n=null,a=new d.default;if(t&&t.toLowerCase()!==a.OBJECT){var r=(e?e.outerHTML:"")||"";r&&(t.toLowerCase()===a.STRING?n=r:t.toLowerCase()===a.URI?n=u.default.uriEncode(r):t.toLowerCase()===a.BASE64&&(n=u.default.base64Encode(r))),n=n||""}else n=e;return this._logger.isDebug()&&this._logger.debug("output: "+(n.outerHTML?n.outerHTML:n)),n}},{key:"capture",value:function(e,t,n){var a=null,r=(new Date).getTime();try{this._overrideOptions(n),this._doc=t||document,this._logger.setLogLevel(this._options.logLevel),this._logger.info("capture() outputType: "+e+" - start");var s=this._getHtmlObject();a=this._prepareOutput(s,e)}catch(e){this._logger.error("capture() - error - "+e.message)}finally{this._logger.info("capture() - end - "+((new Date).getTime()-r)+"ms")}return a}}],[{key:"_getClassName",value:function(e){var t=e.className;return t instanceof SVGAnimatedString?t.baseVal:t}},{key:"_handleElmValue",value:function(e,t){if("input"===e.tagName.toLowerCase()&&"text"===e.getAttribute("type"))t.setAttribute("value",e.value);else if("select"===e.tagName.toLowerCase()&&e.children){t.setAttribute("value",e.value);for(var n=e.children.length-1;n>=0;n--)e.children[n].getAttribute("value")===e.value?t.children[n].setAttribute("selected",""):t.children[n].removeAttribute("selected")}}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=function(){function e(){a(this,e),this._logLevelNames=["debug","info","warn","error","fatal","off"],this.init()}return r(e,[{key:"init",value:function(){this._logLevel=this._logLevelNames.indexOf("warn")}},{key:"setLogLevel",value:function(e){e&&-1!==this._logLevelNames.indexOf(e.toLowerCase())&&(this._logLevel=this._logLevelNames.indexOf(e.toLowerCase()))}},{key:"_log",value:function(e,t){this._logLevel<=this._logLevelNames.indexOf(t)&&console.log("|html-screen-capture-js|"+t+"| "+e)}},{key:"isDebug",value:function(){return this._logLevel===this._logLevelNames.indexOf("debug")}},{key:"debug",value:function(e){this._log(e,"debug")}},{key:"info",value:function(e){this._log(e,"info")}},{key:"warn",value:function(e){this._log(e,"warn")}},{key:"error",value:function(e){this._log(e,"error")}},{key:"fatal",value:function(e){this._log(e,"fatal")}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=function(){function e(){a(this,e)}return r(e,null,[{key:"_utf8_encode",value:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t}},{key:"base64Encode",value:function(t){var n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=void 0,s=void 0,o=void 0,i=void 0,l=void 0,u=void 0,c=void 0,d=0;for(t=e._utf8_encode(t);d<t.length;)r=t.charCodeAt(d++),s=t.charCodeAt(d++),o=t.charCodeAt(d++),i=r>>2,l=(3&r)<<4|s>>4,u=(15&s)<<2|o>>6,c=63&o,isNaN(s)?u=c=64:isNaN(o)&&(c=64),n=n+a.charAt(i)+a.charAt(l)+a.charAt(u)+a.charAt(c);return n}},{key:"uriEncode",value:function(e){return(e?encodeURI(e):"")||""}}]),e}();t.default=s,e.exports=t.default}])});